{% extends "base.html" %}

{% block content %}
<h1>Earthquakes map</h1>
<div id="mapPage">

    <div id="mapItemsList">
        {% for earthquake in earthquakes_S1 %}
        <div id="listItem">
            <p>date:
                <b>{{ earthquake[1] }}</b>
                </br>
                Lattitude:
                <b>{{ earthquake[3] }}</b>
                </br>
                Longtitude:
                <b>{{ earthquake[4] }}</b>
                </br>
                Mw:
                <b>{{ earthquake[11] }}</b>
                M0:
                <b>{{ earthquake[12] }}</b>
                </br>

            </p>


        </div>




        {% endfor %}

    </div>
    <div id="map"></div>
    <script>
        let earthquakesJS = `{{ earthquakes_S1|safe }}`;
        earthquakesJS = earthquakesJS.replaceAll('(', '[');
        earthquakesJS = earthquakesJS.replaceAll(')', ']');
        earthquakesJS = earthquakesJS.replaceAll("'", '"');
        let jsonEarth = JSON.parse(earthquakesJS.replace(/None/g, 'null'));
        // console.log(jsonEarth);

        function initMap() {

            var map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 52.5200, lng: 13.4050 }, // Начальные координаты центра карты [широта, долгота]
                zoom: 10
            });

            var makers2 = [];
            for (let i = 0; i < jsonEarth.length; i++) {
            
                for (let j = 0; j < jsonEarth[i].length; j++) {
                    var adder = { position: { lat: parseFloat(jsonEarth[i][3]), lng: parseFloat(jsonEarth[i][4])}, title: String(i) };
                   


                }
                makers2.push(adder);
            }

            console.log(makers2);


            var markers = [
                { position: { lat: 52.5200, lng: 13.4050 }, title: 'Berlin' }, // Маркер 1
                { position: { lat: 52.52, lng: 13.39 }, title: 'Potsdamer Platz' }, // Маркер 2
                { position: { lat: 52.52, lng: 13.40 }, title: 'Brandenburger Tor' } // Маркер 3
            ];
            console.log(markers);
            console.log(makers2);
            markers = makers2;


           
            markers.forEach(function (markerInfo) {
                var marker = new google.maps.Marker({
                    position: markerInfo.position,
                    map: map,
                    title: markerInfo.title
                });


                marker.addListener('click', function () {
                    alert('Вы кликнули на маркере: ' + markerInfo.title);

                });
            });
        }



    </script>

</div>

{% endblock %}